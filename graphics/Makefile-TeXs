default:	all

# .tex -> .pdf
%.pdf: %.tex
	pdflatex $*
	pdfcrop $*.pdf $*_.pdf
	mv $*_.pdf $*.pdf

%.eps: %.tex
	latex << EOF \
\\documentclass{article} \
\\usepackage{epsfig} \
\\usepackage{amsmath} \
\\usepackage{amssymb} \
\\usepackage{color} \
\\usepackage{listings} \
\\begin{document} \
\\sffamily \
\\def\\normalfont{\\sffamily} \
\\renewcommand{\\familydefault}{cmss} \
\\pagestyle{empty} \
\\thispagestyle{empty} \
\\resizebox{1.0\\textwidth}{!}{\\input{$*}} \
\\end{document} \
EOF
	mv article.dvi $*.dvi
	dvips $*.dvi
	ps2eps --loose < $*.ps > $*.eps
	rm $*.ps
	rm $*.dvi
	rm article.aux
	rm article.log

# Original files
TEXs := $(wildcard *.tex)

# Temporal files
TMPs += $(TEXs:%.tex=%.pdf)
#TMPs += $(TEXs:%.tex=%.eps)

joining.pdf:	joining.tex tracker.pdf splitter_serve_joining_peers.pdf peer_joining.pdf
TMPs += joining.pdf

leaving.pdf:	leaving.tex splitter_serve_leaving_peers.pdf peer_leaving.pdf
TMPs += leaving.pdf

chunk_generation_and_flooding.pdf:	chunk_generation_and_flooding.tex splitter_chunk_generation.pdf peer_chunk_flooding.pdf

all:	$(TMPs)

info:
	@echo $(TMPs)

clean:
	rm -f $(TMPs) *.log *.aux

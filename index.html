<!DOCTYPE html> 
<html> 
<head> <title>P2PSP (Peer-to-Peer Straightforward Protocol)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">P2PSP (Peer-to-Peer Straightforward Protocol)</h2>
 <div class="author" ><span 
class="ecrm-1200">The P2PSP team</span></div><br />
<div class="date" ><span 
class="ecrm-1200">August 19, 2018</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">STS (Splitters Tracking Set)</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-5">DBS (Data Broadcasting Set)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-7">Feeding the team</a></span>
<br />    <span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-8">Joining a team</a></span>
<br />    <span class="subsectionToc" >2.3 <a 
href="#x1-60002.3" id="QQ2-1-9">Buﬀering chunks</a></span>
<br />    <span class="subsectionToc" >2.4 <a 
href="#x1-70002.4" id="QQ2-1-10">Peer’s life (quitar)</a></span>
<br />    <span class="subsectionToc" >2.5 <a 
href="#x1-80002.5" id="QQ2-1-12">Leaving a team</a></span>
<br />    <span class="subsectionToc" >2.6 <a 
href="#x1-90002.6" id="QQ2-1-14">Chunk ﬂooding</a></span>
<br />    <span class="subsectionToc" >2.7 <a 
href="#x1-100002.7" id="QQ2-1-16">Chunk routing</a></span>
<br />    <span class="subsectionToc" >2.8 <a 
href="#x1-110002.8" id="QQ2-1-17">Free-riding control at splitters</a></span>
   </div>
   <div 
class="abstract" 
>
<div class="center" 
>
<!--l. 22--><p class="noindent" >
</p><!--l. 22--><p class="noindent" ><span 
class="ecbx-0900">Abstract</span></p></div>
<!--l. 22--><p class="noindent" >
     </p><!--l. 1--><p class="indent" >   <span 
class="ecrm-0900">P2PSP   (see   </span><a 
href="https://p2psp.github.io" class="url" ><span 
class="ectt-0900">https://p2psp.github.io</span></a><span 
class="ecrm-0900">)   is   an   application-layer</span>
     <span 
class="ecrm-0900">protocol that provides real-time broadcasting, also known as Application</span>
     <span 
class="ecrm-0900">Layer Multicast (ALM), of a media stream on the Internet. As in many</span>
     <span 
class="ecrm-0900">other P2P protocols, peers collaborate to diseminate the stream that is</span>
                                                                  

                                                                  
     <span 
class="ecrm-0900">generated by a single source, minimizing the latency and the protocol</span>
     <span 
class="ecrm-0900">overhead. P2PSP has a modular design organized in </span><span 
class="ecti-0900">sets of rules</span><span 
class="ecrm-0900">, where</span>
     <span 
class="ecrm-0900">each module is especialized in implementing a diﬀerent functionality.</span>
</p>
</div>
<!--l. 26--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>STS (Splitters Tracking Set)</h3>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-20011"></a>
                                                                  

                                                                  
<!--l. 9--><p class="noindent" > <div style="text-align:center;"> <img width=600 src="graphics/icecast-P2PSP.png" /> </div> 
<br />  </p><div class="caption" 
><span class="id">Figure 1:  </span><span  
class="content">A  possible  data-ﬂow  in  an  hybrid  Icecast/P2PSP  network.
<!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
represents                         a                         splitter                         and
<!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
a peer.</span></div><!--tex4ht:label?: x1-20011 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 15--><p class="indent" >   P2PSP supposes that there is a collection of channels that are broadcasted in
parallel.<span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2002f1"></a>  The channels are
available at one or more<span class="footnote-mark"><a 
href="index3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-2003f2"></a> 
streaming <span 
class="ecti-1000">servers</span>, and each channel has a diﬀerent URL (Universal Resource
Locator), usually expressed as a HTTP address with the structure:
                                                                  

                                                                  
</p>
   <div class="verbatim" id="verbatim-1">
  http://name.icecast.server/name_of_the_channel
</div>
<!--l. 27--><p class="nopar" >
</p><!--l. 30--><p class="indent" >   P2PSP does not perform data-ﬂow control over the stream. The transmission
bit-rate between P2PSP entities is controlled by an external server, which provides
the stream. Fig. <a 
href="#x1-20011">1<!--tex4ht:ref: fig:icecast-P2PSP --></a> shows an example of an hybrid Icecast/P2PSP streaming overlay
where several Icecast servers relay a set of channels produced by a set of
source-clients, directly or through other servers, and controlling the data-ﬂow. As can
be seen, a listener (which usually plays de stream) can be replaced by a <span 
class="ecti-1000">splitter</span>, a
P2PSP entity that sends the received stream (a single channel) to a set of P2PSP
<span 
class="ecti-1000">peers</span>, called <span 
class="ecti-1000">team</span>. Notice that, considering that a player can be attached to each
peer, the scalability of the hybrid alternative is much higher than the pure
client/server architecture.
</p><!--l. 53--><p class="indent" >   Usually, users are mainly interested in receiving channels, not in knowing the
topology of the overlay. In a pure Icecast system, users request the channels directly
to the servers. Unfortunately, this simple procedure has a drawback: normally, users
does not know the load of the servers nor their distance to the user’s player.
This problem can be solved using a <span 
class="ecti-1000">load balancer</span>. The listeners (and the
splitters) which know the URL of the required channel, connects ﬁrst to the
load balancer which redirects them (with a HTTP 302 code) to a suitable
server.
</p><!--l. 64--><p class="indent" >   This idea can be extended to take advantage of the existence of P2PSP teams in hybrid
overlays, where some users run a local peer to retrieve a copy of the stream. In this case, the peer
communicates<span class="footnote-mark"><a 
href="index4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-2004f3"></a> 
with the load balancer to tell it that there is a peer running in the same
host that the player. Thus, when the player requests to the load balancer
the reception of the stream, the load balancer redirects it towards the local
peer.<span class="footnote-mark"><a 
href="index5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-2005f4"></a> 
</p><!--l. 87--><p class="indent" >   When a network entity (usually, a player) connects with a peer, it must
connects with a splitter which is transmitting the stream selected by the user.
Depending on maximum number of potential peers that request the same channel,
                                                                  

                                                                  
more than one splitter could be available. This information is served by a
<span 
class="ecti-1000">splitters tracker</span>, and generated when a new splitter is instantiated. The
tracker keeps updated a table indexed by names of channels, where every
entry contains a list of splitters that transmit the corresponding channel.
Therefore, to ﬁnd a suitable splitter, the peer ﬁrst retrieves from the splitters
tracker a list of splitters. Then, the peer tries to connect with all the
splitters<span class="footnote-mark"><a 
href="index6.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-2006f5"></a> 
in parallel, and the fastest connection determines the selected splitter (the rest of
successful connections are closed). This procedure should select the “closest” splitter
to the peer in terms of network latency.
</p><!--l. 112--><p class="indent" >   The splitters send to the tracker a message with the current number
<!--l. 113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi></math> of peers
in their teams. When a splitters (and its team) is created, it sends a message with
<!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi> <mo 
class="MathClass-rel">≥</mo> <mi 
>N</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math> where
<!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math> is the maximum
team size<span class="footnote-mark"><a 
href="index7.html#fn6x0"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-2007f6"></a> 
for that splitter (at least one monitor peer must be in each
team). When the team is full, the splitter sends a message with
<!--l. 118--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>.
When the team is shutted down, the splitter sends a
<!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mn>1</mn></math>.
Using the number of free spaces in each team, the splitters tracker can perform some
load balacing amount the teams including those teams with more room in the
<!--l. 121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mstyle 
class="text"><mtext  >list of splitters</mtext></mstyle></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
response.
                                                                  

                                                                  
</p><!--l. 125--><p class="indent" >   <a 
 id="x1-20082"></a></p><hr class="float" /><div class="float" 
>
                                                                  

                                                                  
 <div style="text-align:center;"> <img width=900 src="graphics/STS_example.png" /> </div> 
<br /> <div class="caption" 
><span class="id">Figure 2: </span><span  
class="content">Timeline example of an STS interaction.</span></div><!--tex4ht:label?: x1-20082 -->
                                                                  

                                                                  
   </div><hr class="endfloat" />
<!--l. 131--><p class="indent" >   The Fig. <a 
href="#x1-20082">2<!--tex4ht:ref: fig:STS_example --></a> shown an example of an STS communication. When the peer is created, it
sends a <!--l. 132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">hello</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
message to the load balancer telling that a player is running in the same
host that the peer and therefore, the peers should be redirected towards
it. When the splitters are instantiated, they send their teams sizes
(<!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>,
supposing that only one monitor has added to each team). The player is redirected to
the peer which, after receiving the list of splitters from the tracker, selects the
Splitter<!--l. 138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> because answers
ﬁrst than the Splitter<!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>.
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>DBS (Data Broadcasting Set)</h3>
   <div class="table">
                                                                  

                                                                  
<!--l. 4--><p class="indent" >   <a 
 id="x1-30011"></a></p><hr class="float" /><div class="float" 
>
                                                                  

                                                                  
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /><col 
id="TBL-2-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-1-1"  
class="td11">                                                          Parameter  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-2"  
class="td11"> Meaning                                                                                                                                                                                                                                 </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-2-1"  
class="td11"> <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">MaxNumTeams</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-2"  
class="td11"> Maximum number of teams                                                                                                                                                                                                        </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-3-1"  
class="td11"> <!--l. 8--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">MaxMumPeers </mi> </math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-2"  
class="td11"> Maximum number of peers in a team</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-4-1"  
class="td11"> <!--l. 9--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">ChunkSize</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-4-2"  
class="td11"> Size of a chunk of media                                                                                                                                                                                                            </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-5-1"  
class="td11"> <!--l. 10--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">BufferSize </mi> </math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-5-2"  
class="td11"> buﬀer size in chunks</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-6-1"  
class="td11"> <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">MaxChunkDebt</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-6-2"  
class="td11"> Maximum chunk debt between peers                                                                                                                                                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-7-1"  
class="td11">                                                                     </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-8-1"  
class="td11"> Entity</td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-8-2"  
class="td11"> Role                                                                                                                                                                                                                                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-9-1"  
class="td11"> <!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">MediaSource</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-9-2"  
class="td11"> the media source                                                                                                                                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-10-1"  
class="td11"> <!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>T</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-10-2"  
class="td11"> all the teams that receive the same media stream                                                                                                                                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-11-1"  
class="td11"> <!--l. 17--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-11-2"  
class="td11"> teams tracker                                                                                                                                                                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-12-1"  
class="td11"> <!--l. 18--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>S</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-12-2"  
class="td11"> the set of splitters broadcasting the same stream                                                                                                                                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-13-1"  
class="td11"> <!--l. 19--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-13-2"  
class="td11"> one of the <!--l. 19--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>T</mi><mo 
class="MathClass-rel">|</mo></math> teams in <!--l. 19--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>T</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-14-1"  
class="td11"> <!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-14-2"  
class="td11"> the splitter of <!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>                                                                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-15-1"  
class="td11"> <!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-15-2"  
class="td11"> <!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th peer of <!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-16-1"  
class="td11"> <!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-16-2"  
class="td11"> the neighbors of <!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>                                                                                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-17-1"  
class="td11">                                                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-18-1"  
class="td11">                                                            Variable  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-18-2"  
class="td11"> Meaning                                                                                                                                                                                                                                 </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-19-1"  
class="td11"> <!--l. 26--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>T</mi></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">≤</mo> <mi 
>G</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-19-2"  
class="td11"> current number of teams broadcasting the same channel                                                                                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-20-1"  
class="td11"> <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">|</mo><mi 
>T</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">≤</mo> <mi 
>N</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-20-2"  
class="td11"> current number of peers in team <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>                                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-21-1"  
class="td11"> <!--l. 29--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>i</mi></mrow></msup 
><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">≤</mo> <mi 
>N</mi></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-21-2"  
class="td11"> current number of neighbor peers in <!--l. 29--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></math>                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-22-"><td  style="text-align:right; white-space:nowrap;" id="TBL-2-22-1"  
class="td11">                                                                    </td></tr></table>
</div>
<br /> <div class="caption" 
><span class="id">Table 1: </span><span  
class="content">Nomenclature used in DBS.</span></div><!--tex4ht:label?: x1-30011 -->
                                                                  

                                                                  
   </div><hr class="endfloat" />
   </div>
<!--l. 34--><p class="indent" >   DBS provides ALM <span class="cite">[<a 
href="#Xbanerjee2002scalable">1</a>]</span> of a media stream in unicast environments <span class="cite">[<a 
href="#Xcomer2003computer">2</a>]</span>. The media
is sent by a streaming server, and received by a splitter (see Sec. <span 
class="ecbx-1000">??</span>). The splitter
divides the stream into a sequence of <span 
class="ecti-1000">chunks</span>, and relay them to its team, where it can be
up to <!--l. 40--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>
peers. Each peer gathers the chunks from the splitter and the rest of peers of the
team, and sends them to a player.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Feeding the team</h4>
<!--l. 8--><p class="noindent" >The splitter divides the stream into chunks of constant
length, and sends exclusively each chunk to a diﬀerent <span 
class="ecti-1000">origin</span>
<span 
class="ecti-1000">peer</span><span class="footnote-mark"><a 
href="index8.html#fn7x0"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-4001f7"></a> ,
using a round-robin schema. The teams are created with a least one monitor
peer<span class="footnote-mark"><a 
href="index9.html#fn8x0"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-4002f8"></a> 
that runs, by default, in the same host that the splitter, and listens to the port 9999.
Chunks are enumerated to distinguish them at the peers.
</p><!--l. 36--><p class="indent" >   We deﬁne a <span 
class="ecti-1000">round </span>as the process of sending a (diﬀerent) chunk from the splitter
to all the peers of the team. In other words, in a round, all peers of the team should
have received a diﬀerent chunk from the splitter. Notice that the round-time is
variable, and depends on the number of peers in the team, the chunk-size, and the
average bit-rate of the media.
</p><!--l. 43--><p class="indent" >   The splitter remembers which chunk, of a list of the last
<!--l. 43--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math>
chunks transmitted to a peer of the team, was sent to each peer.
</p><!--l. 46--><p class="indent" >   <span 
class="ecbx-1000">Note</span>:  See <a 
href="https://github.com/P2PSP/simulator/blob/f0c73be1817e7d3b816cc61cd2c8e59b17f9a0e6/src/core/splitter_dbs.py#L296" ><!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >destination_of_chunk</mtext></mstyle><mrow ><mo 
class="MathClass-open">[</mo><mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math></a>
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Joining a team</h4>
<!--l. 8--><p class="noindent" >After connecting with a splitter, incoming peers request (using a reliable communication) to
the splitter the current list of peers in the team. To minimize the joining time, the peer sends
a <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">hello</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> message
to each peer of the team in parallel with the reception of the list. When a peer of the team
                                                                  

                                                                  
receives a <!--l. 13--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">hello</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
it adds the sender of the message to a table of peers called
<!--l. 14--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >forward</mtext></mstyle><mrow ><mo 
class="MathClass-open">[</mo><mrow></mrow><mo 
class="MathClass-close">]</mo></mrow></math>. If a peer
<!--l. 14--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> has an entry
<!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >forward</mtext></mstyle><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> then, each chunk
received by <!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> and
originated at <!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math> will
be forwarded to <!--l. 16--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
(see Sec. <span 
class="ecbx-1000">??</span>).
</p><!--l. 25--><p class="indent" >   The splitter, in an inﬁnite loop: listens to the incoming peers, sends the list of
peers in the team, and adds the incoming peer to the list.
</p><!--l. 9--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-60002.3"></a>Buﬀering chunks</h4>
<!--l. 8--><p class="noindent" >In order to hide the jitter generated by the physical network and the protocol itself, peers
need to store the received chunks in a buﬀer before playing them. A chunk with index
<!--l. 10--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is inserted in the
position <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>x</mi><mi mathvariant="italic">mod</mi><mi 
>B</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> of the
buﬀer, where <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math>
is the maximum number of chunks that the buﬀer can store.
</p><!--l. 21--><p class="indent" >   The buﬀer is implemented a circular queue of
<!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mi 
>B</mi></math> chunks, which is
ﬁlled up to only <!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math>
chunks in the buﬀering time (half of the queue is unﬁlled). Chunks with a higher
index are inserted in the head of the buﬀer. The chunk pointed by tail of the buﬀer is
sent to the player when a chunk is received.
</p><!--l. 27--><p class="indent" >   The buﬀering time is a key feature in any streaming system because it determines how
much time the peers must wait before start playing the chunks. Considering that chunks can be
lost<span class="footnote-mark"><a 
href="index10.html#fn9x0"><sup class="textsuperscript">9</sup></a></span><a 
 id="x1-6001f9"></a>  or delayed
more than <!--l. 31--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math>
times of chunk, randomly, it is diﬃcult to determine, a priori the optimal
buﬀering time. In the current implementation, peers buﬀer a variable number
of chunks that depends on the order in which chunks are received. If
<!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> is the
(index of the) ﬁrst chunk received, the buﬀering time ﬁnishes when the chunk
<!--l. 36--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mi 
>B</mi></math> is
                                                                  

                                                                  
received.<span class="footnote-mark"><a 
href="index11.html#fn10x0"><sup class="textsuperscript">10</sup></a></span><a 
 id="x1-6002f10"></a> 
</p><!--l. 41--><p class="indent" >   An heuristic that works is the described in the Fig. <span 
class="ecbx-1000">??</span>. As can be seen,
<!--l. 43--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >chunk_to_play</mtext></mstyle></math>
points to the ﬁrst received chunk, that not necessary is the received chunk
with lower index. After that, the buﬀering ﬁnishes when a chunk with index
<!--l. 46--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >chunk_to_play</mtext></mstyle> <mo 
class="MathClass-bin">+</mo> <mstyle 
class="text"><mtext  >BUFFER_SIZE</mtext></mstyle><mo 
class="MathClass-bin">∕</mo><mn>2</mn></math> has been
received.<span class="footnote-mark"><a 
href="index12.html#fn11x0"><sup class="textsuperscript">11</sup></a></span><a 
 id="x1-6003f11"></a> 
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-70002.4"></a>Peer’s life (quitar)</h4>
                                                                  

                                                                  
<!--l. 4--><p class="indent" >   <a 
 id="x1-70013"></a></p><hr class="float" /><div class="float" 
>
                                                                  

                                                                  
 <div style="text-align:center;"> <img width=250 src="graphics/peers_life.png" /> </div> 
<br /> <div class="caption" 
><span class="id">Figure 3: </span><span  
class="content">Main actions carried out by a peer.</span></div><!--tex4ht:label?: x1-70013 -->
                                                                  

                                                                  
   </div><hr class="endfloat" />
<!--l. 8--><p class="noindent" >Peer’s life is described in Fig. <a 
href="#x1-70013">3<!--tex4ht:ref: fig:peers_life --></a>. Peers must: (1) join a team (determined by the
player) in order to access to the contents broadcasted in such team, (2)
buﬀer some chunks before starting playing them and after that, and (3) keep
buﬀering chunks (and sending them to the player) until the media player
quites.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-80002.5"></a>Leaving a team</h4>
<!--l. 3--><p class="noindent" >An outgoing peer must to: (1) say <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">goodbye</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
to the splitter and the neighbor peers (in this order), (2) relay
any pending (received but yet not sent) chunks, and (3) wait for a
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">goodbye</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
from the splitter, in this order. In case of timeout, the leaving procedure is
reset.
</p><!--l. 9--><p class="indent" >   When a peer of the team receives a
<!--l. 9--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">goodbye</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>, removes the
sender from the <!--l. 10--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >forward</mtext></mstyle></math>.
</p><!--l. 12--><p class="indent" >   The splitter removes the peer from the list of peers.
                                                                  

                                                                  
</p><!--l. 16--><p class="indent" >   <a 
 id="x1-80014"></a></p><hr class="float" /><div class="float" 
>
                                                                  

                                                                  
 <div style="text-align:center;"> <img width=400 src="graphics/leaving.png" /> </div> 
<br /> <div class="caption" 
><span class="id">Figure 4: </span><span  
class="content">Leaving a team.</span></div><!--tex4ht:label?: x1-80014 -->
                                                                  

                                                                  
   </div><hr class="endfloat" />
<!--l. 20--><p class="indent" >   All these rules have been describen in Fig. <a 
href="#x1-80014">4<!--tex4ht:ref: fig:leaving --></a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6   </span> <a 
 id="x1-90002.6"></a>Chunk ﬂooding</h4>
                                                                  

                                                                  
<!--l. 4--><p class="indent" >   <a 
 id="x1-90015"></a></p><hr class="float" /><div class="float" 
>
                                                                  

                                                                  
 <div style="text-align:center;"> <img width=300 src="graphics/peer_chunk_flooding.png" /> </div> 
<br /> <div class="caption" 
><span class="id">Figure 5: </span><span  
class="content">Chunk ﬂooding at peers.</span></div><!--tex4ht:label?: x1-90015 -->
                                                                  

                                                                  
   </div><hr class="endfloat" />
<!--l. 7--><p class="noindent" >When a peer <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
receives a chunk, <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
ﬂoods the chunk to each of its neighbors (except the source), using a prioritized round-robin
schema where those peers with a lower debt are selected ﬁrst (see Fig. <a 
href="#x1-90015">5<!--tex4ht:ref: fig:peer_chunk_flooding --></a>). Every time
<!--l. 10--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> sends a
chunk to <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>,
<!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> runs
<!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">debt</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">debt</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>, and
<!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></math> runs
<!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">debt</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="monospace">debt</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>. In ideal circunstances,
debs should be <!--l. 13--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>.
Debs are clipped to <!--l. 13--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">±</mo> <mi 
>D</mi></math>.
Obviously, a high supportivity means a low debt, and viceversa.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.7   </span> <a 
 id="x1-100002.7"></a>Chunk routing</h4>
<!--l. 2--><p class="noindent" >It can happen<span class="footnote-mark"><a 
href="index13.html#fn12x0"><sup class="textsuperscript">12</sup></a></span><a 
 id="x1-10001f12"></a>  that the
received chunk by peer a <!--l. 3--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
from a neighbor peer <!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> is a
duplicate chunk. In this case, <!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
sends to <!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> a
<!--l. 5--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">prune</mi><mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> message,
where <!--l. 5--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
is number of the duplicate chunk. Thus, only the ﬁrst neighbor
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math> to send to
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> a chunk
<!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> “originated” for
example at a peer <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></math>,
will do that in the future (remember that the origin peers are stored in the chunks messages),
at least that <!--l. 9--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
revokes this routing information by sending a
<!--l. 10--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">request</mi><mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> to one or more (possibly
the rest of) peers of <!--l. 11--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>.
Notice that, this process will be succesful only if
<!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> have received
the chunk <!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>.
If this has not happen, this will not have eﬀect. However, notice that in this case this
procedure will be repeated with the reception of the following chunk originated at
<!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></math>, and that
<!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> should use the same
                                                                  

                                                                  
procedure if chunk <!--l. 15--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
is missing.
</p><!--l. 18--><p class="indent" >   It can also happen that some chunks are not received on time (remember that chunks
are transmitted using UDP which is unreliable). A chunk is considered as lost by peer
<!--l. 20--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>
when it is time to send it to the player and the chunk has not
been received. In this moment, as in the previous situation,
<!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> sends a
<!--l. 22--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">request</mi><mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> to one or more (possibly
the rest of) peers of <!--l. 23--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>,
where <!--l. 23--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>m</mi></mrow></msub 
></math> is,
where <!--l. 24--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>y</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>Δ</mi></math>, being
<!--l. 24--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>x</mi></math> the number of closest
received chunk to <!--l. 24--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>,
and <!--l. 25--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Δ</mi></math> is the distance
in chunks between <!--l. 25--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 25--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.8   </span> <a 
 id="x1-110002.8"></a>Free-riding control at splitters</h4>
<!--l. 1--><p class="noindent" >In each team there are a set of <!--l. 1--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>M</mi></mrow><mrow 
><mi 
>j</mi></mrow></msup 
> <mo 
class="MathClass-rel">≤</mo> <mi 
>N</mi></math>
<span 
class="ecti-1000">monitors </span><!--l. 1--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
mathvariant="bold-script">ℳ</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>j</mi></mrow></msubsup 
> <mo 
class="MathClass-rel">∈</mo><msup><mrow 
><mi 
mathvariant="bold-script">𝒯</mi></mrow><mrow 
><mi 
>j</mi></mrow></msup 
></math>
(trusted peers whose behavior is predictable and that are
only known by the splitter), which complain to their splitter
<!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
mathvariant="bold-script">𝒮</mi></mrow><mrow 
><mi 
>j</mi></mrow></msup 
></math> when a chunk is lost.
For every sent chunk <!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
to <!--l. 4--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
mathvariant="bold-script">𝒫</mi></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>j</mi></mrow></msubsup 
></math>,
<!--l. 5--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
mathvariant="bold-script">𝒮</mi></mrow><mrow 
><mi 
>j</mi></mrow></msup 
></math> performs
<!--l. 5--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>D</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msubsup><mrow 
><mi 
mathvariant="bold-script">𝒫</mi></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>j</mi></mrow></msubsup 
></math>
to associate every sent chunk with its destination (origin) peer
<!--l. 6--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
mathvariant="bold-script">𝒫</mi></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>j</mi></mrow></msubsup 
></math>. If happens
that <!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
<!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi mathvariant="monospace">LC</mi><mspace width="1em" class="nbsp" /><mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
(<!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">L</mi></math>ost
<!--l. 7--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">C</mi></math>hunk)
messages have beeen received from any of the monitors (the splitter only considers
these kind of messages if they come from a monitor) in a number of rounds (see
Fig. <span 
class="ecbx-1000">??</span> for the exact computation of the number of lost chunks per peer per round),
then <!--l. 12--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
mathvariant="bold-script">𝒫</mi></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>j</mi></mrow></msubsup 
></math>
is considered as a gone peer and it is removed from the list of peers of the
splitter.
</p><!--l. 15--><p class="indent" >   <span 
class="ecbx-1000">Note</span>:  This last functionality has not been implemented, at least, as it has been
explained here. The <span 
class="ectt-1000">forget </span>thread is controlled by a timer, not by a counter of
rounds.
                                                                  

                                                                  
</p><!--l. 1--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-120002.8"></a>References</h3>
<!--l. 1--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">   </span></span><a 
 id="Xbanerjee2002scalable"></a>Suman Banerjee, Bobby Bhattacharjee, and Christopher Kommareddy.
   <span 
class="ecti-1000">Scalable application layer multicast</span>, volume 32. ACM, 2002.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">   </span></span><a 
 id="Xcomer2003computer"></a>Douglas E  Comer  and  Ralph E  Droms.    <span 
class="ecti-1000">Computer  networks  and</span>
   <span 
class="ecti-1000">internets</span>. Prentice-Hall, Inc., 2003.
</p>
   </div>
    
</body> 
</html>
                                                                  


